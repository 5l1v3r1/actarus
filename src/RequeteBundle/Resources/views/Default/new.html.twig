{% extends 'base.html.twig' %}


{% block body %}
    <div class="mod mod-requete-new">
        <a href="{{ url('requete_homepage') }}" class="btn btn-default pull-right" style="margin-right:20px;">Cancel</a>
        <h2 class="page-title">Create a new request</h2>

        <div class="row">
            <div class="col-md-6">
                <div class="panel panel-default">
                    <div class="panel-heading">Basic infos</div>
                    <div class="panel-body">
                        {{ form_start(form,{'attr':{'class':'form-horizontal'}}) }}
                            {{ form_row(form._token) }}
                            <div class="form-group">
                                {{ form_label(form.project,'Project *',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.project,{'attr':{'class':'form-control'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.project) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group" style="margin:0px;padding:0px;">
                                <div class="form-group col-sm-6" style="margin:0px;">
                                    {{ form_label(form.protocol,'Protocol *',{'label_attr':{'class':'col-sm-4 control-label'}}) }}
                                    <div class="col-sm-8" style="margin:0px;padding:0px;">
                                        {{ form_widget(form.protocol,{'attr':{'class':'form-control'}}) }}
                                        <span class="help-block m-b-none">{{ form_errors(form.protocol) }}</span>
                                    </div>
                                </div>
                                <div class="form-group col-sm-6" style="margin:0px;padding-right:0px;">
                                    {{ form_label(form.method,'Method *',{'label_attr':{'class':'col-sm-4 control-label'}}) }}
                                    <div class="col-sm-8" style="margin:0px;padding:0px;">
                                        {{ form_widget(form.method,{'attr':{'class':'form-control'}}) }}
                                        <span class="help-block m-b-none">{{ form_errors(form.method) }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.url,'Url *',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.url,{'attr':{'class':'form-control','placeholder':'http://www.example.com/doc/download.php?id=956'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.url) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.host,'Host *',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.host,{'attr':{'class':'form-control','placeholder':'www.example.com'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.host) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.port,'Port *',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.port,{'attr':{'class':'form-control'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.port) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.path,'Path *',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.path,{'attr':{'class':'form-control','placeholder':'/doc/download.php'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.path) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.query,'Query',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.query,{'attr':{'class':'form-control','placeholder':'id=956'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.query) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.data,'Data',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.data,{'attr':{'class':'form-control','rows':5,'placeholder':'csrf_token=g769havq889lhd4iu7beg5if90&format=xml'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.data) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.header,'Header',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.header,{'attr':{'class':'form-control','rows':5,'placeholder':'csrf_token=g769havq889lhd4iu7beg5if90&format=xml'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.header) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                {{ form_label(form.cookie,'Cookie',{'label_attr':{'class':'col-sm-2 control-label'}}) }}
                                <div class="col-sm-10">
                                    {{ form_widget(form.cookie,{'attr':{'class':'form-control','rows':5,'placeholder':'csrf_token=g769havq889lhd4iu7beg5if90&format=xml'}}) }}
                                    <span class="help-block m-b-none">{{ form_errors(form.cookie) }}</span>
                                </div>
                            </div>
                            <div class="hr-dashed"></div>
                            <div class="form-group">
                                <div class="col-sm-8 col-sm-offset-2">
                                    <button class="btn btn-primary" type="submit">Save changes</button>
                                </div>
                            </div>
                        {{ form_end(form) }}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}


{% block javascripts %}
    <script type="text/javascript">
        $(document).ready(function(){
            $('#requete_url').focus();
    
            $('#requete_url').on('change',function(){
                $.ajax({
                    url: '{{ url('requete_spliturl') }}',
                    data: 'url='+Base64.encode($('#requete_url').val()),
                    dataType: 'json',
                    method: 'POST'            
                })
                .success(function(data){
                    if( data['host'] ) {
                        $('#requete_host').val( data['host'] );
                    }
                    if( data['port'] ) {
                        $('#requete_port').val( data['port'] );
                    }
                    if( data['protocol'] ) {
                        $('#requete_protocol').val( data['protocol'] );
                    }
                    if( data['path'] ) {
                        $('#requete_path').val( data['path'] );
                    }
                    if( data['query'] ) {
                        $('#requete_query').val( data['query'] );
                    }
                });
            });
        });
    </script>
{% endblock %}
